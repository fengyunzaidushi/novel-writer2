---
description: 规划详细的章节结构和情节安排
scripts:
  sh: .specify/scripts/bash/setup-outline.sh
  ps: .specify/scripts/powershell/setup-outline.ps1
---

基于已创建的故事大纲，制定详细的章节规划：

## 智能方法应用（新增）

1. **读取项目配置**
   ```javascript
   import { aiInterface } from '../src/ai-interface';
   const config = await aiInterface.getCurrentConfig();
   const method = config.method || 'three-act';
   ```

2. **根据方法选择模板**
   - 如果是单一方法：加载 `spec/presets/[method]/outline.md`
   - 如果是混合方法：读取 `config.hybridScheme` 并应用

3. **智能章节分配**
   - 根据方法的节奏要求分配章节
   - 确保关键节点（如七点结构的中点）位置正确
   - 为混合方法协调不同层级的结构

## 创建章节规划

1. 运行脚本 `{SCRIPT}` 初始化章节规划文件

2. 加载故事大纲 `stories/*/story.md` 理解故事内容

3. **根据写作方法使用对应的规划模板**
   - 三幕结构：25%设置、50%对抗、25%解决
   - 英雄之旅：12个阶段的章节分配
   - 故事圈：8个步骤的循环安排
   - 七点结构：7个关键节点的精确定位
   - 皮克斯公式：6步公式的因果链条

4. **混合方法的特殊处理**
   ```javascript
   if (config.method === 'hybrid' && config.hybridScheme) {
     // 主线按主要方法安排
     // 支线按次要方法规划
     // 章节内部按微观方法组织
   }
   ```

5. 创建章节规划，包含：
   - **总体结构**：总章节数、每章字数、更新计划
   - **方法映射**：每章对应的方法节点
   - **卷/部划分**：如有多卷，划分各卷主题
   - **详细章节**：每章的主要事件、角色发展、情节功能
   - **节奏控制**：高潮分布、悬念设置、情感曲线

6. 将规划写入 `stories/*/outline.md`

7. 创建章节文件夹结构 `stories/*/chapters/`

## 方法特定的规划要点

### 三幕结构
- 第一幕末尾要有第一个转折点
- 第二幕中点要有重大转变
- 第三幕要紧凑有力

### 英雄之旅
- 明确标记每个阶段的章节范围
- 导师出现、考验、重生等关键时刻

### 故事圈
- 每个循环步骤的章节分配
- 需求→搜索→找到→付出→回归的完整循环

### 七点结构
- 精确定位7个关键节点的章节
- 确保收紧点真正增加压力

### 皮克斯公式
- 清晰的因果链条
- 每个"因此"都要推进故事

规划原则：
- 每章应有明确的目标和冲突
- 注意节奏的张弛有度
- 伏笔和回收要标记清楚
- 高潮要合理分布，不能都挤在最后