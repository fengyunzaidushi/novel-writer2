# Novel Writer - AI 驱动的中文小说创作工具

[![npm version](https://badge.fury.io/js/novel-writer-cn.svg)](https://www.npmjs.com/package/novel-writer-cn)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

> 🚀 基于 Spec Kit 架构的 AI 智能小说创作助手

## ✨ 特性

- 📚 **AI 斜杠命令** - 在 Claude、Cursor、Gemini CLI、Windsurf 等 AI 助手中直接使用
- 🎯 **结构化创作** - 从风格设定到章节写作的完整工作流
- 🤖 **智能辅助** - AI 理解上下文，提供针对性创作建议
- 📝 **中文优化** - 专为中文小说创作设计的命令和模板
- 🔄 **跨平台支持** - Windows PowerShell 和 Unix/Linux Bash 脚本
- 🎓 **专家模式** - 获取剧情、人物、世界观、文风等专业指导
- 🔌 **插件系统** - 可扩展的功能模块，如翻译、营销等

### 🆕 v0.8.2 Google Gemini CLI 支持

- 🌐 **Gemini CLI 集成** - 完整支持 Google Gemini CLI 斜杠命令
- 📝 **TOML 格式命令** - 13 个预定义的 TOML 格式命令
- 🔄 **双格式支持** - Markdown（Claude/Cursor/Windsurf）和 TOML（Gemini）同时支持
- 🔌 **插件兼容** - 插件可同时提供两种格式
- 🎯 **智能转换** - 自动将 Markdown 命令转换为 TOML 格式

### v0.5.0 AI 原生交互升级

- 🤖 **智能方法选择** - AI 通过对话了解需求，推荐最适合的写作方法
- 🎯 **6种写作方法** - 支持三幕结构、英雄之旅、故事圈、七点结构、皮克斯公式、雪花十步
- 🔄 **方法转换** - 在不同写作方法之间智能转换
- 🎨 **混合方法** - 主线、支线、章节可使用不同方法组合
- 💬 **自然语言交互** - 无需记住命令参数，通过对话完成所有操作

### v0.4.0 追踪系统

- 🔍 **情节追踪** - 追踪情节节点、伏笔和冲突发展
- ⏰ **时间线管理** - 维护故事时间轴，确保时间逻辑一致
- 👥 **关系矩阵** - 管理角色关系和派系动态
- 🌍 **世界观检查** - 验证设定一致性，避免矛盾
- ✅ **一致性检查** - 全方位验证小说的逻辑连贯性

## 🚀 快速开始

### 安装

```bash
npm install -g novel-writer-cn
```

### 初始化项目

```bash
# 创建新的小说项目
novel init my-novel

# 或在当前目录初始化
novel init --here

# 包含专家模式
novel init my-novel --with-experts

# 指定 AI 平台（Gemini CLI）
novel init my-novel --ai gemini

# 支持所有 AI 平台
novel init my-novel --all

# 预装插件
novel init my-novel --plugins translate
```

### 在 AI 助手中使用斜杠命令

初始化后，在 Claude、Cursor、Gemini CLI、Windsurf 等 AI 助手中使用以下斜杠命令：

> **Gemini CLI 用户**：命令使用 `:` 分隔符，如 `/track:init`、`/plot:check`

#### 核心创作命令
1. **`/method`** - 🆕 智能选择最适合的写作方法（v0.5.0）
2. **`/style`** - 设定创作风格和准则
3. **`/story`** - 创建故事大纲（智能选择方法模板）
4. **`/outline`** - 规划章节结构（应用所选方法）
5. **`/chapters`** - 生成具体的写作任务
6. **`/write`** - AI 辅助写作章节内容

#### 追踪管理命令
7. **`/plot-check`** - 检查情节发展的一致性
8. **`/timeline`** - 管理和验证故事时间线
9. **`/relations`** - 追踪角色关系变化
10. **`/world-check`** - 验证世界观设定一致性
11. **`/track`** - 综合追踪创作进度和内容

#### 专家模式命令（需要 --with-experts）
12. **`/expert`** - 列出可用专家
13. **`/expert plot`** - 剧情结构专家
14. **`/expert character`** - 人物塑造专家
15. **`/expert world`** - 世界观设计专家
16. **`/expert style`** - 文风语言专家

## 📖 斜杠命令详解

### `/method` - 智能写作方法选择 🆕

AI 通过友好对话了解你的故事设想，智能推荐最适合的写作方法：
- 自动分析故事类型、长度、读者等特征
- 推荐单一方法或混合方法方案
- 解释推荐理由和使用建议
- 自动应用到后续创作流程

示例对话：
```
用户：/method
AI：你好！我来帮你选择最适合的写作方法。你想写什么类型的故事呢？
用户：我想写一个20万字的奇幻冒险故事
AI：[分析特征，推荐英雄之旅，解释原因，应用到项目]
```

### `/style` - 设定创作风格

设定你的创作风格，包括：
- 叙事视角（第一人称/第三人称）
- 文字风格（简洁明快/华丽优美）
- 创作原则
- 质量标准

### `/story` - 创建故事大纲

创建完整的故事设定：
- 故事概述和核心冲突
- 主要角色设定
- 世界观和背景
- 情节大纲（起承转合）

示例：
```
/story 一个关于穿越者在修仙世界的冒险故事
```

### `/outline` - 章节规划

制定详细的章节结构：
- 总体结构和章节数
- 卷/部划分
- 每章主要事件
- 节奏控制和高潮分布

### `/chapters` - 任务分解

将章节规划分解为可执行的任务：
- 章节写作任务
- 角色完善任务
- 世界观补充
- 修订任务

### `/write` - 章节写作

AI 辅助创作具体章节内容：
- 根据大纲创作
- 保持风格一致
- 角色性格连贯
- 情节逻辑清晰

### `/plot-check` - 情节检查 (v0.4.0 新增)

检查情节发展的一致性和连贯性：
- 验证当前进度与大纲规划是否一致
- 追踪已埋设的伏笔和回收计划
- 确认冲突升级符合预期节奏
- 验证角色发展与规划一致

### `/timeline` - 时间线管理 (v0.4.0 新增)

维护和验证故事时间线：
- 追踪每个章节的时间点
- 管理同时发生的多线剧情
- 与真实历史事件对比（历史小说）
- 检查时间跨度的合理性

### `/relations` - 关系追踪 (v0.4.0 新增)

管理和追踪角色关系变化：
- 维护角色之间的关系图谱
- 记录关系的演变历程
- 追踪各势力派系的对立与合作
- 管理角色间的情感发展

### `/world-check` - 世界观检查 (v0.4.0 新增)

验证世界观设定的一致性：
- 验证规则、法则、体系的一致
- 检查地点、距离、方位的合理性
- 确保风俗、语言、传统的统一
- 验证能力范围和限制

### `/track` - 综合追踪 (v0.4.0 新增)

全面展示小说创作的各项进度和状态：
- 写作进度（字数、章节、完成率）
- 情节发展（主线进度、支线状态）
- 时间线（故事时间推进）
- 角色状态（角色发展和位置）
- 伏笔管理（埋设和回收状态）

## 📁 项目结构

```
my-novel/
├── .specify/          # Spec Kit 配置
│   ├── spec.md        # 命令规范文档
│   ├── memory/        # 创作记忆
│   └── scripts/       # 支持脚本
├── .claude/           # Claude 命令
│   └── commands/      # 斜杠命令文件
├── spec/              # 小说规格数据 (v0.4.0 新增)
│   ├── tracking/      # 动态追踪
│   │   ├── plot-tracker.json      # 情节追踪
│   │   ├── timeline.json          # 时间线
│   │   ├── relationships.json     # 关系矩阵
│   │   └── character-state.json   # 角色状态
│   └── knowledge/     # 知识库
│       ├── world-setting.md       # 世界观设定
│       ├── character-profiles.md  # 角色档案
│       └── locations.md           # 场景地点
├── stories/           # 故事内容
│   └── 001-故事名/
│       ├── story.md   # 故事大纲
│       ├── outline.md # 章节规划
│       ├── progress.json # 进度追踪
│       └── chapters/  # 章节内容
└── scripts/           # 支持脚本
    ├── bash/          # Unix/Linux/Mac
    └── powershell/    # Windows
```

## 🤖 支持的 AI 助手

- **Claude** (推荐) - Anthropic 的 AI 助手
- **Cursor** - AI 代码编辑器
- **Gemini** - Google 的 AI 助手
- 其他支持斜杠命令的 AI 工具

## 🛠️ CLI 命令

### `novel init [name]`

初始化小说项目

**选项：**
- `--here` - 在当前目录初始化
- `--ai <type>` - 选择 AI 助手类型 (claude/cursor/gemini)
- `--with-experts` - 包含专家模式
- `--plugins <names>` - 预装插件（逗号分隔）

### `novel plugins`

插件管理命令

- `novel plugins list` - 列出已安装插件
- `novel plugins add <name>` - 安装插件
- `novel plugins remove <name>` - 移除插件

### `novel check`

检查项目配置和状态

## 📚 支持的写作方法

Novel Writer 支持多种经典写作方法，由 AI 智能推荐：

| 方法 | 特点 | 适用场景 |
|------|------|----------|
| **三幕结构** | 经典的设置-对抗-解决 | 通用，适合大多数类型 |
| **英雄之旅** | 12阶段的成长历程 | 奇幻、冒险、成长故事 |
| **故事圈** | 8步循环结构 | 角色驱动、心理深度 |
| **七点结构** | 7个关键节点 | 悬疑、惊悚、紧凑叙事 |
| **皮克斯公式** | 6步因果链 | 短篇、儿童故事 |
| **雪花十步** | 递进式细化构建 | 长篇、复杂故事结构 |

### 混合方法

支持在不同层级使用不同方法：
- **主线**：控制整体故事结构
- **支线**：角色弧线或支线情节
- **章节**：单个场景或章节内部

## 🎓 专家模式

获取专业的写作指导：

### 核心专家
- **剧情结构专家** (`/expert plot`) - 情节设计、节奏控制、冲突升级
- **人物塑造专家** (`/expert character`) - 人物弧光、动机分析、对话优化
- **世界观设计专家** (`/expert world`) - 世界构建、设定一致性、文化背景
- **文风语言专家** (`/expert style`) - 叙述技巧、修辞手法、语言风格

### 使用方式
1. 使用 `/expert` 列出可用专家
2. 使用 `/expert [type]` 激活特定专家
3. 进入专家模式后获得深度指导
4. 使用其他 `/` 命令自动退出专家模式

## 🔌 插件系统

扩展 Novel Writer 的功能：

### 内置插件
- **翻译插件** - 中英文小说翻译和本地化
  - `/translate` - 四步翻译流程
  - `/polish` - 英文润色优化
  - `/expert translate` - 翻译专家模式

### 插件管理
```bash
# 列出已安装插件
novel plugins list

# 安装插件
novel plugins add translate

# 移除插件
novel plugins remove translate
```

## 📚 工作流程

### 智能创作流程 (v0.5.0)

1. **选择写作方法**
   ```
   /method
   ```
   AI 通过对话了解需求，推荐最适合的方法

2. **创建故事大纲**
   ```
   /story
   ```
   自动应用选定的方法模板

3. **规划章节结构**
   ```
   /outline
   ```
   根据方法要求分配章节

4. **开始写作**
   ```
   /write
   ```

### 基础创作流程

1. **初始化项目**
   ```bash
   novel init my-novel
   cd my-novel
   ```

2. **设定创作风格**
   在 AI 助手中使用 `/style` 命令设定你的创作风格

3. **创建故事大纲**
   使用 `/story` 命令，提供故事描述，AI 会帮助创建完整大纲

4. **规划章节**
   使用 `/outline` 命令制定详细的章节结构

5. **生成任务**
   使用 `/chapters` 命令将规划分解为具体任务

6. **开始写作**
   使用 `/write` 命令，AI 会根据大纲协助创作

### 质量保障流程 (v0.4.0 新增)

7. **情节检查**
   定期使用 `/plot-check` 确保情节发展与大纲一致，追踪伏笔状态

8. **时间线验证**
   使用 `/timeline` 管理时间节点，验证时间逻辑的合理性

9. **关系维护**
   使用 `/relations` 追踪角色关系变化，确保人物互动合理

10. **世界观验证**
    使用 `/world-check` 检查设定一致性，避免前后矛盾

11. **综合追踪**
    使用 `/track` 查看整体创作状态，获取全局视图

## 🎯 最佳实践

### AI 原生交互 (v0.5.0)
- **自然对话**：用自然语言描述需求，AI 会理解并引导
- **智能选择**：让 AI 根据故事特征推荐方法
- **灵活转换**：随时可以转换或混合使用方法
- **持续支持**：AI 记住你的选择并在全程应用

### 创作建议
- **保持一致性**：始终参考 `memory/writing-constitution.md` 中的风格设定
- **循序渐进**：按照工作流程顺序使用命令
- **版本管理**：使用 Git 管理你的创作版本
- **定期备份**：重要内容及时备份

### 质量控制
- **定期检查**：每写完 5-10 章执行一次 `/plot-check`
- **时间线同步**：每个重要事件后更新 `/timeline`
- **关系追踪**：角色关系发生变化时及时更新
- **设定记录**：新增世界观设定立即记录到知识库
- **综合验证**：每卷结束时运行 `/track` 全面检查

## 📈 版本更新

### v0.6.0 (2025-01)
- 🎓 专家模式系统
- 🔌 插件架构实现
- 🌍 翻译插件支持
- 📚 四位核心专家
- 🔧 插件管理命令

### v0.5.2 (2024-12)
- ❄️ 雪花十步法支持
- 🎯 6种经典写作方法完整支持
- 🔄 智能方法转换
- 🎨 混合方法设计
- 💬 自然语言对话

### v0.4.0 (2024-01)
- 🔍 情节追踪系统
- ⏰ 时间线管理
- 👥 关系矩阵
- 🌍 世界观检查
- ✅ 一致性验证

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

项目地址：[https://github.com/wordflowlab/novel-writer](https://github.com/wordflowlab/novel-writer)

## 📄 许可证

MIT License

## 🙏 致谢

本项目基于 [Spec Kit](https://github.com/sublayerapp/spec-kit) 架构设计，特此感谢！

---

**Novel Writer** - 让 AI 成为你的创作伙伴！ ✨📚